# OWASP ZAP Configuration File
# Configuración para escaneos de seguridad DAST

# ============================================
# URLs Excluidas del Escaneo
# ============================================

# Excluir logout (evitar cerrar sesión durante escaneo)
-exclude "http://localhost:5173/logout"
-exclude "http://localhost:4173/logout"

# Excluir archivos estáticos (CSS, JS, imágenes)
# Estos no son vulnerables a OWASP Top 10
-exclude ".*\.(css|js|png|jpg|jpeg|gif|svg|ico|woff|woff2|ttf|eot)$"

# Excluir node_modules y vendor paths
-exclude ".*/node_modules/.*"
-exclude ".*/vendor/.*"

# ============================================
# Context Rules
# ============================================

# Permitir todas las direcciones API
-config api.addrs.addr.name=.*
-config api.addrs.addr.regex=true

# ============================================
# Scan Policy
# ============================================

# Nivel de alerta mínimo: WARN (Medium, High)
# Opciones: PASS (solo High), WARN (Medium+High), FAIL (cualquier alerta)
-l WARN

# ============================================
# Performance Settings
# ============================================

# Timeout para requests (en segundos)
-T 120

# Número máximo de alerts por tipo
-m 10

# ============================================
# Reporting
# ============================================

# Incluir información detallada en reportes
-config report.include.details=true

# ============================================
# Authentication (si es necesario)
# ============================================

# Descomentar y configurar si necesitas escanear endpoints protegidos
# -config auth.method=form
# -config auth.loginurl=http://localhost:5173/login
# -config auth.username=test@example.com
# -config auth.password=testpassword
# -config auth.username.field=email
# -config auth.password.field=password

# ============================================
# Scan Optimization
# ============================================

# Reducir falsos positivos
-config alert.maxinstance=5

# Spider configuration (para full scans)
-config spider.maxduration=10
-config spider.maxdepth=5

# ============================================
# Notas de Uso
# ============================================

# Uso en Docker:
# docker run --rm -v $(pwd)/security:/zap/wrk/ \
#   softwaresecurityproject/zap-stable \
#   zap-baseline.py \
#   -t http://host.docker.internal:5173 \
#   -c zap-config.conf \
#   -r zap-report.html

# Uso con script PowerShell:
# .\scripts\zap-scan.ps1 -TargetUrl http://localhost:5173 -ScanType baseline
